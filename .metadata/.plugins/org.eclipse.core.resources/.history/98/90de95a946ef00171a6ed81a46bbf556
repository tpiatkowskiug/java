package dao;

import java.sql.Connection;
import java.sql.DriverManager;
import java.sql.SQLException;
import java.sql.Statement;

import model.Klient;
import org.apache.log4j.Logger;

public class SqliteDAOFactory extends DAOFactory {
	private static final Logger logger = Logger
            .getLogger(MysqlDAOFactory.class);

    public static final String DRIVER = "org.sqlite.JDBC";
    public static final String DBURL = "jdbc:sqlite:test.db";

    /**
     * Method to create a Connection on the sqlite-database.
     * 
     * @return the Connection.
     */
    
    private Connection conn;
    private Statement stat;
 
    public SqliteDAOFactory() {
        try {
            Class.forName(SqliteDAOFactory.DRIVER);
        } catch (ClassNotFoundException e) {
            System.err.println("Brak sterownika JDBC");
            e.printStackTrace();
        }
 
        try {
            conn = DriverManager.getConnection(DBURL);
            stat = conn.createStatement();
        } catch (SQLException e) {
            System.err.println("Problem z otwarciem polaczenia");
            e.printStackTrace();
        }
 
        createTables();
    }
 
//    public static Connection createConnection() {
//    	
//    	Connection conn = null;
//        try {
//            Class.forName(DRIVER);
//            conn = DriverManager.getConnection(DBURL);
//        } catch (SQLException e) {
//            logger.error(e.getMessage());
//        } catch (ClassNotFoundException e) {
//            logger.error(e.getMessage());
//        }
//        return conn;
//    }
    @Override
	public IKlientDAO getKlientDAO() {
		return new SqliteKlientDAO();
	}

}
